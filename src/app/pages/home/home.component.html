<div class="container">
  <h1>Accueil</h1>

  <h2>Opérations récentes</h2>
  <div>
    <ng-container *ngFor="let operation of operations; let i = index">
      <p>{{getDateString(operation.date)}} : {{operation.montant}} ({{operation.commentaire}}) {{operation.remboursable === '1' ? 'remboursable' : ''}}
        <button (click)="updateEditMode(operation)">{{operation.edit !== true ? 'Modifier ↓' : 'Cacher ↑'}}</button>
      </p>
      <div class="form-container" [class.none]="operation.edit !== true">

        <div class="form-element">
          <div class="form-element-title">
            <label [for]="'date_' + i">Date</label>
          </div>
          <div class="form-element-content">
            <input
                type="date"
                [id]="'date_' + i"
                [ngModel]="operation.date | date:'yyyy-MM-dd'"
                (ngModelChange)="updateDate(operation, $event)"
            >
          </div>
        </div>

        <div class="form-element">
          <div class="form-element-title">
            <label>Signe</label>
          </div>
          <div class="form-element-content">
            <input
                type="radio" value="1"
                [name]="'signe_' + i"
                [id]="'entree_' + i"
                (change)="updateSigne(operation, 1)"
                [checked]="operation.montant >= 0"
            >
            <label [for]="'entree_' + i">Entrée</label>
            <input
                type="radio" value="-1"
                [name]="'signe_' + i"
                [id]="'sortie_' + i"
                (change)="updateSigne(operation, -1)"
                [checked]="operation.montant < 0"
            >
            <label [for]="'sortie_' + i">Sortie</label>
          </div>
        </div>

        <div class="form-element">
          <div class="form-element-title">
            <label [for]="'montant_' + i">Montant</label>
          </div>
          <div class="form-element-content">
            <input
                type="number" step="0.01"
                [id]="'montant_' + i"
                [ngModel]="operation.montant"
                (focusout)="updateMontant(operation, $event.target.value)"
                (keyup.enter)="updateMontant(operation, $event.target.value)">
          </div>
        </div>

        <div class="form-element">
          <div class="form-element-title">
            <label [for]="'commentaire_' + i">Commentaire</label>
          </div>
          <div class="form-element-content">
            <input
                type="text"
                [id]="'commentaire_' + i"
                [ngModel]="operation.commentaire"
                (focusout)="updateCommentaire(operation, $event.target.value)"
                (keyup.enter)="updateCommentaire(operation, $event.target.value)">
          </div>
        </div>

        <div class="form-element">
          <div class="form-element-title">
            <label [for]="'remboursable_' + i">Remboursable</label>
          </div>
          <div class="form-element-content">
            <input
                type="checkbox"
                [id]="'remboursable_' + i"
                [ngModel]="operation.remboursableCheckbox"
                (ngModelChange)="updateRemboursable(operation, $event)"
                [checked]="operation.remboursable === '1'">
          </div>
        </div>

      </div>
  </ng-container>
  </div>
</div>
